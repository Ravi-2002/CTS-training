import axios from "axios";
import { changeParent } from "./devices"; // adjust path to your devices file

jest.mock("axios");

describe("changeParent coverage", () => {
  beforeEach(() => {
    jest.clearAllMocks();
  });

  it("should call axios.post with correct params", async () => {
    // mock apiUrl()
    const mockApiUrl = () => ({
      retrieveNumberShareDetails: "/mock-endpoint"
    });
    global.apiUrl = mockApiUrl; // if apiUrl is global, mock it like this

    // mock axios response
    axios.post.mockResolvedValue({ data: { status: "200" } });

    const params = {
      moveFrom: "123",
      secondaryDevice: "456",
      moveTo: "789"
    };

    await changeParent(params);

    expect(axios.post).toHaveBeenCalledWith(
      "/mock-endpoint",
      {
        trunkMdn: "123",
        branchMtn: "456",
        newtrunkMdn: "789",
        numberShareIndicator: "M"
      },
      {
        headers: {
          pageName: "numberShare",
          flowName: "numberShare"
        }
      }
    );
  });
});