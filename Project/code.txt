import React from "react";
import { render } from "@testing-library/react";
import { BlockCallsMessages } from "../BlockCallsMessages"; // unconnected

describe("BlockCallsMessages handleInput/handleOnChange coverage", () => {
  let instance;
  const mockProps = {
    selectedDevice: { encryptedMtn: "123" },
    selectedAccordian: "",
    blockedNumbers: [],
    expiredNumbers: [],
    callsMessagesData: {},
    getCallsMessages: jest.fn(),
    postaddBlockCallMsg: jest.fn(),
    postDeleteBlockCallMsg: jest.fn(),
  };

  beforeEach(() => {
    const { container } = render(<BlockCallsMessages {...mockProps} />);
    instance = container.firstChild._reactInternals.child.stateNode;
  });

  it("handleOnChange for valid number sets newNumber and addnumberValid=true", () => {
    const event = { target: { value: "1234567890" } };
    instance.handleOnChange(event, "number");
    expect(instance.state.newNumber).toBe("123.456.7890");
    expect(instance.state.addnumberValid).toBe(true);
  });

  it("handleOnChange for incomplete number sets addnumberValid=false", () => {
    const event = { target: { value: "12345" } };
    instance.handleOnChange(event, "number");
    expect(instance.state.addnumberValid).toBe(false);
  });

  it("handleOnChange for non-number input leaves newNumber but addnumberValid=false", () => {
    const event = { target: { value: "abc" } };
    instance.handleOnChange(event, "number");
    expect(instance.state.newNumber).toBe("a.b.c");
    expect(instance.state.addnumberValid).toBe(false);
  });

  it("handleInput checkbox updates applyAllFlag", () => {
    const event = { target: { checked: true } };
    instance.handleInput(event, "checkbox");
    expect(instance.state.applyAllFlag).toBe(true);
  });
});